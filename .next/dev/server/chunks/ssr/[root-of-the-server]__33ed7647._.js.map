{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/noahpique/Documents/AnthemTool/anthem-songwish/src/components/SongSearch.tsx"],"sourcesContent":["import React, {\n  FormEvent,\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n} from \"react\";\n\nexport type Track = {\n  id: string;\n  name: string;\n  artists: string;\n  album?: string;\n  spotify_url?: string;\n  image_url?: string | null;\n  duration_ms?: number;\n};\n\ntype SongSearchProps = {\n  onSelect: (track: Track) => void;\n  /** id of the currently selected track so the list can highlight it */\n  selectedId?: string | null;\n  /** if true, focus the search input when the component mounts */\n  autoFocus?: boolean;\n  /** optional initial query to prefill the search input */\n  initialQuery?: string;\n};\n\nconst SongSearch: React.FC<SongSearchProps> = ({\n  onSelect,\n  selectedId = null,\n  autoFocus = false,\n  initialQuery,\n}) => {\n  const [query, setQuery] = useState(initialQuery ?? \"\");\n  const [results, setResults] = useState<Track[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const inputRef = useRef<HTMLInputElement | null>(null);\n\n  useEffect(() => {\n    if (autoFocus) {\n      // small timeout to ensure element is mounted and visible when called from modal\n      setTimeout(() => inputRef.current?.focus(), 0);\n    }\n  }, [autoFocus]);\n\n  // Keep internal query in sync when parent provides a new initialQuery\n  useEffect(() => {\n    setQuery(initialQuery ?? \"\");\n  }, [initialQuery]);\n\n  const runSearch = useCallback(\n    async (trigger: \"manual\" | \"debounced\", overrideQuery?: string) => {\n      const raw = typeof overrideQuery === \"string\" ? overrideQuery : query;\n      const trimmedQuery = raw.trim();\n\n      if (trimmedQuery.length < 3) {\n        if (trigger === \"manual\") {\n          setError(\"Bitte gib mindestens drei Zeichen ein.\");\n        } else {\n          setError(null);\n        }\n        setResults([]);\n        setLoading(false);\n        return;\n      }\n\n      setLoading(true);\n      setError(null);\n\n      try {\n        const response = await fetch(\n          `/api/search?q=${encodeURIComponent(trimmedQuery)}`\n        );\n        const data: { tracks?: Track[]; error?: string } = await response\n          .json()\n          .catch(() => ({}));\n\n        if (!response.ok) {\n          throw new Error(data?.error ?? \"Die Suche war nicht erfolgreich.\");\n        }\n\n        setResults(data.tracks ?? []);\n      } catch (err) {\n        console.error(\"Song search failed\", err);\n        setError(\n          \"Beim Suchen ist ein Fehler aufgetreten. Bitte versuch es erneut.\"\n        );\n        setResults([]);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [query]\n  );\n\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const trimmedQuery = query.trim();\n\n    if (!trimmedQuery) {\n      setError(\"Bitte gib einen Suchbegriff ein.\");\n      setResults([]);\n      return;\n    }\n\n    await runSearch(\"manual\", trimmedQuery);\n  };\n\n  // Debounced auto-search when the user types\n  useEffect(() => {\n    const trimmed = query.trim();\n\n    if (trimmed.length === 0) {\n      setResults([]);\n      setError(null);\n      setLoading(false);\n      return;\n    }\n\n    if (trimmed.length < 3) {\n      setResults([]);\n      setLoading(false);\n      return;\n    }\n\n    const debounceTimer = window.setTimeout(() => {\n      void runSearch(\"debounced\");\n    }, 450); // 450ms debounce keeps the UI responsive without flooding the API\n\n    return () => {\n      window.clearTimeout(debounceTimer);\n    };\n  }, [query, runSearch]);\n\n  // If the parent supplies an initialQuery (e.g. when editing an existing\n  // selection), prefill the input and trigger an immediate search so the user\n  // sees results right away.\n  useEffect(() => {\n    if (!initialQuery) return;\n    setQuery(initialQuery);\n    const trimmed = initialQuery.trim();\n    if (trimmed.length >= 3) {\n      // run an immediate search using the provided initialQuery\n      void runSearch(\"manual\", trimmed);\n    } else {\n      // small queries should clear previous results\n      setResults([]);\n      setError(null);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [initialQuery]);\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      <form\n        onSubmit={handleSubmit}\n        className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3\"\n      >\n        <div className=\"relative w-full\">\n          <input\n            type=\"text\"\n            ref={inputRef}\n            value={query}\n            onChange={(event) => setQuery(event.target.value)}\n            placeholder=\"Song oder Artist eingeben...\"\n            aria-label=\"Song oder Artist eingeben\"\n            className=\"w-full rounded-lg border border-white/15 bg-white/10 px-3 py-2 pr-10 text-sm text-white placeholder-gray-400 focus:border-fuchsia-500 focus:outline-none focus:ring-2 focus:ring-fuchsia-400/40\"\n          />\n\n          {query.trim().length > 0 && (\n            <button\n              type=\"button\"\n              onClick={() => {\n                setQuery(\"\");\n                setResults([]);\n                setError(null);\n                // refocus the input for continued typing\n                setTimeout(() => inputRef.current?.focus(), 0);\n              }}\n              aria-label=\"Suche löschen\"\n              className=\"absolute right-2 top-1/2 -translate-y-1/2 rounded p-1 text-gray-500 hover:bg-gray-100 hover:text-gray-700\"\n            >\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 24 24\"\n                width=\"14\"\n                height=\"14\"\n                aria-hidden=\"true\"\n                focusable=\"false\"\n                className=\"inline-block\"\n              >\n                <path\n                  d=\"M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.9 4.89a1 1 0 1 0 1.41 1.41L12 13.41l4.89 4.9a1 1 0 0 0 1.41-1.41L13.41 12l4.9-4.89a1 1 0 0 0 0-1.4z\"\n                  fill=\"currentColor\"\n                />\n              </svg>\n            </button>\n          )}\n        </div>\n\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"w-full rounded bg-gray-700 px-4 py-2 text-sm font-medium text-white transition hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-70 sm:w-auto\"\n        >\n          {loading ? \"Suche...\" : \"Suchen\"}\n        </button>\n      </form>\n\n      {error && <p className=\"text-sm text-red-600\">{error}</p>}\n\n      {!loading && !error && results.length === 0 && (\n        <p className=\"text-sm text-gray-500\">\n          {query.trim().length < 3\n            ? \"Gib mindestens drei Zeichen ein, um Songs zu finden.\"\n            : \"Keine Ergebnisse gefunden. Versuch eine andere Suche.\"}\n        </p>\n      )}\n\n      <div className=\"flex flex-col gap-3\">\n        {results.map((track) => {\n          const isSelected = selectedId === track.id;\n          return (\n            <button\n              key={track.id}\n              type=\"button\"\n              onClick={() => onSelect(track)}\n              aria-pressed={isSelected}\n              className={`flex items-start gap-3 rounded border p-3 text-left transition sm:items-center ${\n                isSelected\n                  ? \"border-indigo-500 bg-indigo-50 shadow-md\"\n                  : \"border-gray-100 bg-white hover:bg-gray-50\"\n              }`}\n            >\n              {track.image_url ? (\n                // eslint-disable-next-line @next/next/no-img-element\n                <img\n                  src={track.image_url}\n                  alt={track.name}\n                  className=\"h-14 w-14 rounded object-cover\"\n                  loading=\"lazy\"\n                />\n              ) : (\n                <div className=\"flex h-14 w-14 items-center justify-center rounded bg-gray-200 text-xs text-gray-600\">\n                  Kein Bild\n                </div>\n              )}\n              <div className=\"flex flex-1 flex-col\">\n                <span className=\"text-sm font-semibold text-gray-900 sm:text-base\">\n                  {track.name}\n                </span>\n                <span className=\"text-xs text-gray-600 sm:text-sm\">\n                  {track.artists}\n                </span>\n                {track.album && (\n                  <span className=\"text-xs text-gray-400 sm:text-sm\">\n                    {track.album}\n                  </span>\n                )}\n              </div>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SongSearch;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 324, "column": 0}, "map": {"version":3,"sources":["file:///Users/noahpique/Documents/AnthemTool/anthem-songwish/src/components/SongSearchModal.tsx"],"sourcesContent":["import React from \"react\";\n\nimport SongSearch, { Track } from \"./SongSearch\";\n\ntype SongSearchModalProps = {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (track: Track) => void;\n  selectedTrackId?: string | null;\n  initialQuery?: string;\n};\n\nconst SongSearchModal: React.FC<SongSearchModalProps> = ({\n  isOpen,\n  onClose,\n  onSelect,\n  selectedTrackId = null,\n  initialQuery,\n}) => {\n  if (!isOpen) {\n    return null;\n  }\n\n  const handleSelect = (track: Track) => {\n    onSelect(track);\n    onClose();\n  };\n\n  // Close when clicking the overlay (outside modal content)\n  const handleOverlayMouseDown = (e: React.MouseEvent<HTMLDivElement>) => {\n    // only close when the overlay itself is clicked, not children\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 flex items-center justify-center overflow-y-auto bg-black/70 px-3 py-10 sm:px-4\"\n      onMouseDown={handleOverlayMouseDown}\n      role=\"presentation\"\n    >\n      <div\n        className=\"relative w-full max-w-lg rounded-3xl p-5 shadow-[0_28px_56px_rgba(0,0,0,0.6)] sm:max-w-2xl sm:p-7\"\n        style={{\n          background:\n            \"linear-gradient(145deg, rgba(27,27,36,0.95), rgba(22,21,32,0.8))\",\n          border: \"1px solid rgba(255,255,255,0.08)\",\n          backdropFilter: \"blur(26px)\",\n        }}\n      >\n        <button\n          type=\"button\"\n          onClick={onClose}\n          className=\"absolute right-4 top-4 flex h-9 w-9 items-center justify-center rounded-full bg-white/10 text-lg text-gray-200 shadow-[0_6px_16px_rgba(0,0,0,0.4)] transition hover:bg-white/20 sm:h-10 sm:w-10\"\n          aria-label=\"Schließen\"\n        >\n          <span aria-hidden>×</span>\n        </button>\n        <h2 className=\"mb-4 text-lg font-semibold text-white sm:text-xl\">\n          Song auswählen\n        </h2>\n        <div className=\"max-h-[70vh] overflow-y-auto pr-1\">\n          <SongSearch\n            onSelect={handleSelect}\n            selectedId={selectedTrackId ?? null}\n            autoFocus\n            initialQuery={initialQuery}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SongSearchModal;\n"],"names":[],"mappings":";;;;;AAEA;;;AAUA,MAAM,kBAAkD,CAAC,EACvD,MAAM,EACN,OAAO,EACP,QAAQ,EACR,kBAAkB,IAAI,EACtB,YAAY,EACb;IACC,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IAEA,MAAM,eAAe,CAAC;QACpB,SAAS;QACT;IACF;IAEA,0DAA0D;IAC1D,MAAM,yBAAyB,CAAC;QAC9B,8DAA8D;QAC9D,IAAI,EAAE,MAAM,KAAK,EAAE,aAAa,EAAE;YAChC;QACF;IACF;IAEA,qBACE,qKAAC;QACC,WAAU;QACV,aAAa;QACb,MAAK;kBAEL,cAAA,qKAAC;YACC,WAAU;YACV,OAAO;gBACL,YACE;gBACF,QAAQ;gBACR,gBAAgB;YAClB;;8BAEA,qKAAC;oBACC,MAAK;oBACL,SAAS;oBACT,WAAU;oBACV,cAAW;8BAEX,cAAA,qKAAC;wBAAK,aAAW;kCAAC;;;;;;;;;;;8BAEpB,qKAAC;oBAAG,WAAU;8BAAmD;;;;;;8BAGjE,qKAAC;oBAAI,WAAU;8BACb,cAAA,qKAAC,oIAAU;wBACT,UAAU;wBACV,YAAY,mBAAmB;wBAC/B,SAAS;wBACT,cAAc;;;;;;;;;;;;;;;;;;;;;;AAM1B;uCAEe","debugId":null}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["file:///Users/noahpique/Documents/AnthemTool/anthem-songwish/src/pages/index.tsx"],"sourcesContent":["import Head from \"next/head\";\nimport type { NextPage } from \"next\";\nimport React, { FormEvent, useEffect, useMemo, useState } from \"react\";\nimport { useRouter } from \"next/router\";\n\nimport SongSearchModal from \"../components/SongSearchModal\";\nimport type { Track } from \"../components/SongSearch\";\n\nconst MAX_SONGS = 3;\n\nconst HomePage: NextPage = () => {\n  const [selectedTracks, setSelectedTracks] = useState<Array<Track | null>>(\n    () => Array(MAX_SONGS).fill(null)\n  );\n  const [activeSlotIndex, setActiveSlotIndex] = useState<number | null>(null);\n  const [isSearchOpen, setIsSearchOpen] = useState(false);\n  const [modalInitialQuery, setModalInitialQuery] = useState<\n    string | undefined\n  >(undefined);\n\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [submitSuccess, setSubmitSuccess] = useState<string | null>(null);\n  const [channel, setChannel] = useState<string | null>(null);\n  const [channelError, setChannelError] = useState<string | null>(null);\n\n  const router = useRouter();\n\n  useEffect(() => {\n    if (!router.isReady) {\n      return;\n    }\n\n    try {\n      const raw = router.query.channel;\n      const value = Array.isArray(raw) ? raw[0] : raw;\n      if (typeof value === \"string\" && value.trim().length > 0) {\n        setChannel(value.trim());\n        setChannelError(null);\n      } else {\n        setChannel(null);\n      }\n    } catch (error) {\n      console.error(\"Failed to parse channel from query\", error);\n      setChannel(null);\n      setChannelError(\"Channel-Parameter konnte nicht gelesen werden.\");\n    }\n  }, [router.isReady, router.query.channel]);\n\n  const hasAnySelection = useMemo(\n    () => selectedTracks.some((track) => track !== null),\n    [selectedTracks]\n  );\n\n  const openSearchForSlot = (slotIndex: number) => {\n    setActiveSlotIndex(slotIndex);\n    const track = selectedTracks[slotIndex];\n    if (track) {\n      setModalInitialQuery(`${track.name} ${track.artists}`);\n    } else {\n      setModalInitialQuery(undefined);\n    }\n    setIsSearchOpen(true);\n  };\n\n  const closeSearch = () => {\n    setIsSearchOpen(false);\n    setActiveSlotIndex(null);\n    setModalInitialQuery(undefined);\n  };\n\n  const handleSelectTrack = (track: Track) => {\n    if (activeSlotIndex === null) {\n      return;\n    }\n\n    const existsInOtherSlot = selectedTracks.some(\n      (selected, index) =>\n        selected?.id === track.id && index !== activeSlotIndex\n    );\n\n    if (existsInOtherSlot) {\n      alert(\"Du hast diesen Song bereits ausgewählt.\");\n      return;\n    }\n\n    setSelectedTracks((prev) => {\n      const copy = [...prev];\n      copy[activeSlotIndex] = track;\n      return copy;\n    });\n    setSubmitSuccess(null);\n    // close the search modal after selecting a track so the change is applied immediately\n    closeSearch();\n  };\n\n  const handleRemoveTrack = (index: number) => {\n    setSelectedTracks((prev) => {\n      const copy = [...prev];\n      copy[index] = null;\n      return copy;\n    });\n    setSubmitSuccess(null);\n  };\n\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n\n    if (!hasAnySelection) {\n      setSubmitError(\"Bitte wähle mindestens einen Song aus.\");\n      return;\n    }\n\n    setSubmitError(null);\n    setSubmitSuccess(null);\n    setSubmitting(true);\n\n    const tracksToSubmit = selectedTracks.filter(\n      (track): track is Track => track !== null\n    );\n\n    try {\n      const response = await fetch(\"/api/wish\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          firstName,\n          lastName,\n          email,\n          tracks: tracksToSubmit,\n          channel: channel ?? undefined,\n        }),\n      });\n\n      const data: { success?: boolean; message?: string; error?: string } =\n        await response.json().catch(() => ({}));\n\n      if (!response.ok || !data.success) {\n        // Prefer a server-provided error message when available so the user sees validation issues\n        const apiError =\n          data.error ?? \"Dein Songwunsch konnte nicht gespeichert werden.\";\n        setSubmitError(apiError);\n        return;\n      }\n\n      setSubmitSuccess(data.message ?? \"Deine Songwünsche wurden gespeichert.\");\n    } catch (error) {\n      console.error(\"Wish submission failed\", error);\n      // If we catch here, prefer the caught error message when available\n      const message =\n        error instanceof Error\n          ? error.message\n          : \"Beim Speichern deiner Songwünsche ist ein Fehler aufgetreten.\";\n      setSubmitError(message);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <>\n      <Head>\n        <title>Song Wish</title>\n        <meta\n          name=\"description\"\n          content=\"Wähle deine Nightlife-Favoriten – bis zu drei Tracks, die an der Greatest Party Anthems Primetime laufen sollen.\"\n        />\n      </Head>\n      <main\n        className=\"mx-auto flex min-h-screen w-full max-w-3xl flex-col gap-8 px-4 py-10 sm:px-6 sm:py-14\"\n        style={{\n          background:\n            \"radial-gradient(120% 110% at 50% -10%, rgba(255,0,128,0.35), rgba(14,14,20,0.96) 65%)\",\n        }}\n      >\n        <section\n          className=\"w-full overflow-hidden rounded-[28px] px-7 py-8 shadow-[0_24px_48px_rgba(0,0,0,0.55)] sm:px-9\"\n          style={{\n            backdropFilter: \"blur(24px)\",\n            background:\n              \"linear-gradient(140deg, rgba(24,24,32,0.92), rgba(20,20,28,0.65))\",\n            border: \"1px solid rgba(255,255,255,0.08)\",\n          }}\n        >\n          <h1 className=\"text-3xl font-bold tracking-tight text-white sm:text-4xl\">\n            Greatest Party Anthems - Song Selection\n          </h1>\n          <p className=\"mt-5 max-w-xl text-sm leading-relaxed text-gray-300 sm:text-base\">\n            Wähle bis zu drei Tracks, die auf die Primetime-Playlist gehören. Je\n            öfter ein Song genannt wird, desto grösser die Chance, dass der\n            Track gespielt wird.\n          </p>\n        </section>\n\n        <section className=\"space-y-3\">\n          {Array.from({ length: MAX_SONGS }).map((_, idx) => {\n            const track = selectedTracks[idx];\n\n            return (\n              <div\n                key={idx}\n                className=\"flex flex-col gap-4 rounded-3xl p-4 shadow-[0_18px_36px_rgba(0,0,0,0.5)] sm:flex-row sm:items-center sm:justify-between sm:gap-4\"\n                style={{\n                  backdropFilter: \"blur(18px)\",\n                  background:\n                    \"linear-gradient(150deg, rgba(28,28,36,0.88), rgba(22,22,32,0.62))\",\n                  border: \"1px solid rgba(255,255,255,0.06)\",\n                }}\n              >\n                <div className=\"flex flex-1 items-start gap-3 sm:items-center\">\n                  <span className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-linear-to-br from-fuchsia-500 to-purple-600 text-sm font-semibold text-white shadow-[0_10px_22px_rgba(244,63,94,0.35)]\">\n                    {idx + 1}\n                  </span>\n                  {track ? (\n                    <div className=\"flex flex-1 items-start gap-3 sm:items-center\">\n                      {track.image_url ? (\n                        // eslint-disable-next-line @next/next/no-img-element\n                        <img\n                          src={track.image_url}\n                          alt={track.name}\n                          className=\"h-16 w-16 rounded-2xl object-cover shadow-[0_16px_28px_rgba(0,0,0,0.55)]\"\n                        />\n                      ) : (\n                        <div className=\"flex h-16 w-16 items-center justify-center rounded-2xl bg-gray-700/60 text-xs text-gray-300\">\n                          Kein Bild\n                        </div>\n                      )}\n                      <div>\n                        <div className=\"text-sm font-semibold text-white sm:text-base\">\n                          {track.name}\n                        </div>\n                        <div className=\"text-xs text-gray-300 sm:text-sm\">\n                          {track.artists}\n                        </div>\n                        {track.album && (\n                          <div className=\"text-xs text-gray-400 sm:text-sm\">\n                            Album: {track.album}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"text-sm text-gray-400 sm:text-base\">\n                      Noch kein Song gewählt\n                    </div>\n                  )}\n                </div>\n                <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3\">\n                  {track && (\n                    <button\n                      type=\"button\"\n                      className=\"text-xs text-gray-400 underline transition hover:text-rose-300 sm:text-sm\"\n                      onClick={() => handleRemoveTrack(idx)}\n                    >\n                      Entfernen\n                    </button>\n                  )}\n                  <button\n                    type=\"button\"\n                    className=\"w-full rounded-xl px-4 py-2 text-sm font-semibold text-white transition sm:w-auto\"\n                    style={{\n                      background:\n                        \"linear-gradient(125deg, rgba(252,70,100,0.85), rgba(110,15,255,0.85))\",\n                      boxShadow: \"0 14px 28px rgba(250,70,120,0.32)\",\n                    }}\n                    onClick={() => openSearchForSlot(idx)}\n                  >\n                    {track ? \"Ändern\" : \"Song wählen\"}\n                  </button>\n                </div>\n              </div>\n            );\n          })}\n        </section>\n\n        <section\n          className=\"rounded-3xl p-5 shadow-[0_24px_42px_rgba(0,0,0,0.55)] sm:p-6\"\n          style={{\n            background:\n              \"linear-gradient(140deg, rgba(22,22,32,0.92), rgba(28,24,48,0.7))\",\n            border: \"1px solid rgba(255,255,255,0.08)\",\n            backdropFilter: \"blur(22px)\",\n          }}\n        >\n          <h2 className=\"mb-4 text-lg font-semibold text-white sm:text-xl\">\n            Deine Angaben\n          </h2>\n          <form className=\"flex flex-col gap-4\" onSubmit={handleSubmit}>\n            <div className=\"flex flex-col gap-1\">\n              <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\n                <div>\n                  <label\n                    htmlFor=\"firstName\"\n                    className=\"text-sm font-medium text-gray-200\"\n                  >\n                    Vorname\n                  </label>\n                  <input\n                    id=\"firstName\"\n                    type=\"text\"\n                    value={firstName}\n                    onChange={(event) => setFirstName(event.target.value)}\n                    className=\"mt-1 block w-full rounded-lg border border-white/10 bg-white/10 px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-fuchsia-500 focus:outline-none focus:ring-2 focus:ring-fuchsia-400/40\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label\n                    htmlFor=\"lastName\"\n                    className=\"text-sm font-medium text-gray-200\"\n                  >\n                    Nachname\n                  </label>\n                  <input\n                    id=\"lastName\"\n                    type=\"text\"\n                    value={lastName}\n                    onChange={(event) => setLastName(event.target.value)}\n                    className=\"mt-1 block w-full rounded-lg border border-white/10 bg-white/10 px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-fuchsia-500 focus:outline-none focus:ring-2 focus:ring-fuchsia-400/40\"\n                    required\n                  />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex flex-col gap-1\">\n              <label\n                htmlFor=\"email\"\n                className=\"text-sm font-medium text-gray-200\"\n              >\n                E-Mail-Adresse\n              </label>\n              <input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(event) => setEmail(event.target.value)}\n                className=\"rounded-lg border border-white/10 bg-white/10 px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-fuchsia-500 focus:outline-none focus:ring-2 focus:ring-fuchsia-400/40\"\n                required\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={submitting}\n              className=\"w-full rounded-lg px-4 py-3 text-sm font-semibold text-white transition disabled:cursor-not-allowed disabled:opacity-70 sm:w-auto\"\n              style={{\n                background:\n                  \"linear-gradient(115deg, rgba(255, 110, 50, 0.85), rgba(178, 55, 255, 0.85))\",\n                boxShadow: \"0 14px 28px rgba(178, 55, 255, 0.3)\",\n              }}\n            >\n              {submitting ? \"Sende...\" : \"Songwunsch abschicken\"}\n            </button>\n\n            {submitError && (\n              <p className=\"text-sm text-rose-400\">{submitError}</p>\n            )}\n            {submitSuccess && (\n              <p className=\"text-sm text-emerald-400\">{submitSuccess}</p>\n            )}\n            {channelError && (\n              <p className=\"text-sm text-amber-400\">{channelError}</p>\n            )}\n          </form>\n        </section>\n      </main>\n\n      <SongSearchModal\n        isOpen={isSearchOpen}\n        onClose={closeSearch}\n        onSelect={handleSelectTrack}\n        selectedTrackId={\n          activeSlotIndex !== null\n            ? selectedTracks[activeSlotIndex]?.id ?? null\n            : null\n        }\n        initialQuery={modalInitialQuery}\n      />\n    </>\n  );\n};\n\nexport default HomePage;\n"],"names":[],"mappings":"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","debugId":null}}]
}