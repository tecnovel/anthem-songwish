module.exports=[6663,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(8695),g=a.i(8171),h=a.i(9059),i=a.i(7669);a.s(["default",0,()=>{let[a,b]=(0,i.useState)(!0),[c,d]=(0,i.useState)(""),[e,f]=(0,i.useState)(!1),[j,k]=(0,i.useState)(null),[l,m]=(0,i.useState)([]),[n,o]=(0,i.useState)([]),p=(0,i.useRef)("");(0,i.useEffect)(()=>{p.current=c},[c]);let q=(0,i.useMemo)(()=>{let b=new URLSearchParams;return b.set("grouped",a?"true":"false"),c.trim()&&b.set("q",c.trim()),`/api/admin/export?${b.toString()}`},[a,c]),r=(0,i.useCallback)(async(a,b)=>{f(!0),k(null);try{let c=new URLSearchParams;c.set("grouped",a?"true":"false"),b&&c.set("q",b);let d=await fetch(`/api/admin/song-wishes?${c.toString()}`),e=await d.json();if(!d.ok||"error"in e)throw Error(e.error??"Failed to load data");e.grouped?(m(e.items),o([])):(o(e.items),m([]))}catch(a){k(a instanceof Error?a.message:"Unknown error")}finally{f(!1)}},[]);(0,i.useEffect)(()=>{r(a,p.current.trim())},[a,r]);let s=(0,i.useCallback)(()=>{r(a,c.trim())},[r,a,c]),t=(0,i.useCallback)(a=>{b(a.target.checked)},[]),[u,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)(null),[y,z]=(0,i.useState)([]),[A,B]=(0,i.useState)(!1),[C,D]=(0,i.useState)(null),E=(0,i.useCallback)(async a=>{x(a),v(!0),B(!0),D(null);try{let b=new URLSearchParams;b.set("grouped","false"),b.set("trackId",a.trackId);let c=await fetch(`/api/admin/song-wishes?${b.toString()}`),d=await c.json().catch(()=>null);if(!c.ok)throw Error(d&&d.error||`Fehler beim Laden (${c.status})`);let e=(Array.isArray(d?.items)?d.items:[]).filter(b=>b.trackId===a.trackId);z(e)}catch(a){D(a instanceof Error?a.message:String(a))}finally{B(!1)}},[]),F=(0,i.useCallback)(()=>{v(!1),x(null),z([]),D(null)},[]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(h.default,{children:[(0,g.jsx)("title",{children:"Admin – Songwünsche"}),(0,g.jsx)("meta",{name:"robots",content:"noindex"})]}),(0,g.jsx)("div",{className:"min-h-screen bg-gray-50 px-4 py-8 sm:px-6 sm:py-12",children:(0,g.jsxs)("div",{className:"mx-auto flex w-full max-w-5xl flex-col gap-6",children:[(0,g.jsxs)("header",{className:"flex flex-col gap-2 text-center sm:text-left",children:[(0,g.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 sm:text-3xl",children:"Admin – Songwünsche"}),(0,g.jsx)("p",{className:"text-sm text-gray-600 sm:text-base",children:"Übersicht der eingegangenen Songwünsche. Nutze die Optionen, um nach Songs oder Gästen zu filtern und die Daten zu exportieren."})]}),(0,g.jsx)("section",{className:"flex flex-col gap-4 rounded-2xl border border-gray-100 bg-white p-4 shadow-sm sm:p-6",children:(0,g.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[(0,g.jsxs)("div",{className:"flex w-full flex-col gap-2 sm:flex-row sm:items-stretch sm:gap-3",children:[(0,g.jsx)("input",{value:c,onChange:a=>d(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),s())},placeholder:"Suche nach Song, Artist oder Gast...",className:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-black focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-100"}),(0,g.jsx)("button",{type:"button",onClick:s,className:"w-full rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-indigo-500 sm:w-auto",children:"Suchen"})]}),(0,g.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4",children:[(0,g.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,g.jsx)("input",{type:"checkbox",checked:a,onChange:t,className:"h-4 w-4"}),(0,g.jsx)("span",{children:"Songs gruppieren (Ranking)"})]}),(0,g.jsx)("a",{href:q,className:"rounded-lg border border-gray-200 px-3 py-2 text-sm font-medium text-gray-700 transition hover:border-gray-300 hover:text-gray-900",children:"Export als CSV"})]})]})}),(0,g.jsxs)("section",{className:"rounded-2xl border border-gray-100 bg-white p-4 shadow-sm sm:p-6",children:[e&&(0,g.jsx)("p",{className:"text-sm text-gray-500",children:"Lade..."}),j&&(0,g.jsx)("p",{className:"text-sm text-red-600",children:j}),!e&&!j&&a&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"hidden md:block -mx-4 overflow-x-auto sm:-mx-6 lg:mx-0",children:(0,g.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,g.jsx)("thead",{className:"border-b border-gray-200 text-xs uppercase tracking-wide text-gray-500",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"#"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Votes"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Track"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Artists"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Album"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Spotify"})]})}),(0,g.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[0===l.length&&(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:6,className:"px-4 py-4 text-center text-sm text-gray-500",children:"Keine Einträge gefunden."})}),l.map((a,b)=>(0,g.jsxs)("tr",{onClick:()=>E(a),className:"cursor-pointer hover:bg-gray-50",children:[(0,g.jsx)("td",{className:"px-4 py-3 font-semibold text-gray-700 whitespace-nowrap",children:b+1}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-700 whitespace-nowrap",children:a.voteCount}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-900 whitespace-nowrap truncate max-w-56",children:a.trackName}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-600 whitespace-nowrap truncate max-w-44",children:a.trackArtists}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-500 whitespace-nowrap truncate max-w-40",children:a.album??""}),(0,g.jsx)("td",{className:"px-4 py-3",children:a.spotifyUrl?(0,g.jsxs)("a",{href:a.spotifyUrl,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-1 text-sm font-medium text-white hover:bg-indigo-500",children:[(0,g.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4","aria-hidden":!0,children:[(0,g.jsx)("path",{d:"M15 3v4a2 2 0 0 1-2 2H7",strokeLinecap:"round",strokeLinejoin:"round"}),(0,g.jsx)("path",{d:"M10 14L21 3",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Spotify"]}):(0,g.jsx)("span",{className:"text-gray-400",children:"—"})})]},a.trackId))]})]})}),(0,g.jsxs)("div",{className:"md:hidden flex flex-col gap-3",children:[0===l.length&&(0,g.jsx)("div",{className:"px-4 py-4 text-center text-sm text-gray-500",children:"Keine Einträge gefunden."}),l.map((a,b)=>(0,g.jsx)("div",{onClick:()=>E(a),className:"rounded-lg border border-gray-100 bg-white p-3 shadow-sm cursor-pointer",children:(0,g.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,g.jsxs)("div",{className:"min-w-0",children:[(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsx)("span",{className:"inline-flex items-center justify-center h-6 w-6 rounded-full bg-indigo-50 text-indigo-700 text-sm font-semibold",children:b+1}),(0,g.jsx)("div",{className:"font-semibold text-gray-900 truncate",children:a.trackName})]}),(0,g.jsx)("div",{className:"text-sm text-gray-600 truncate",children:a.trackArtists}),a.album?(0,g.jsx)("div",{className:"text-sm text-gray-500 truncate",children:a.album}):null]}),(0,g.jsxs)("div",{className:"shrink-0 text-right",children:[(0,g.jsxs)("div",{className:"text-sm text-gray-700 font-semibold whitespace-nowrap",children:[a.voteCount,"×"]}),a.spotifyUrl?(0,g.jsxs)("a",{href:a.spotifyUrl,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-1 text-sm font-medium text-white hover:bg-indigo-500",children:[(0,g.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4","aria-hidden":!0,children:[(0,g.jsx)("path",{d:"M15 3v4a2 2 0 0 1-2 2H7",strokeLinecap:"round",strokeLinejoin:"round"}),(0,g.jsx)("path",{d:"M10 14L21 3",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Spotify"]}):null]})]})},a.trackId))]})]}),u&&w&&(0,g.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,g.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:F}),(0,g.jsxs)("div",{className:"relative z-10 max-w-2xl w-full rounded-lg bg-white shadow-lg",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between border-b px-4 py-3",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:w.trackName}),(0,g.jsx)("div",{className:"text-sm text-gray-600",children:w.trackArtists})]}),(0,g.jsx)("button",{onClick:F,className:"ml-4 rounded-md bg-gray-100 px-3 py-1 text-sm text-gray-700 hover:bg-gray-200",children:"Schliessen"})]}),(0,g.jsxs)("div",{className:"px-4 py-4",children:[(0,g.jsxs)("div",{className:"flex gap-4",children:[w.imageUrl?(0,g.jsx)("img",{src:w.imageUrl,alt:w.trackName,className:"h-28 w-28 rounded-md object-cover"}):(0,g.jsx)("div",{className:"h-28 w-28 rounded-md bg-gray-100"}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsxs)("div",{className:"text-sm text-gray-700 mb-2",children:["Album: ",w.album??"—"]}),w.spotifyUrl&&(0,g.jsxs)("a",{href:w.spotifyUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 rounded-md bg-green-600 px-3 py-1 text-sm font-medium text-white hover:bg-green-500",children:[(0,g.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,className:"h-4 w-4","aria-hidden":!0,children:[(0,g.jsx)("path",{d:"M3 12h18",strokeLinecap:"round",strokeLinejoin:"round"}),(0,g.jsx)("path",{d:"M14 5l7 7-7 7",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Auf Spotify öffnen"]})]}),(0,g.jsxs)("div",{className:"text-sm text-gray-700 mb-2",children:["Votes: ",w.voteCount]}),(0,g.jsxs)("div",{className:"text-sm text-gray-700",children:["Dauer:"," ",w.durationMs?Math.round((w.durationMs||0)/1e3)+"s":"—"]})]})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Gewählt von"}),A&&(0,g.jsx)("p",{className:"text-sm text-gray-600",children:"Lade…"}),C&&(0,g.jsx)("p",{className:"text-sm text-red-600",children:C}),!A&&!C&&0===y.length&&(0,g.jsx)("p",{className:"text-sm text-gray-600",children:"Keine Wähler gefunden."}),!A&&y.length>0&&(0,g.jsx)("ul",{className:"max-h-64 overflow-auto divide-y divide-gray-100",children:y.map(a=>(0,g.jsxs)("li",{className:"flex items-center justify-between gap-3 py-2",children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[a.firstName," ",a.lastName]}),(0,g.jsxs)("div",{className:"text-xs text-gray-600",children:[a.email," • Slot ",a.slotIndex+1]})]}),(0,g.jsx)("div",{className:"text-xs text-gray-500",children:new Date(a.createdAt).toLocaleString()})]},a.id))})]})]})]})]}),!e&&!j&&!a&&(0,g.jsx)("div",{className:"-mx-4 overflow-x-auto sm:-mx-6 lg:mx-0",children:(0,g.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,g.jsx)("thead",{className:"border-b border-gray-200 text-xs uppercase tracking-wide text-gray-500",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Datum"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Name"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"E-Mail"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Track"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Artists"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Slot"}),(0,g.jsx)("th",{className:"px-3 py-2 whitespace-nowrap",children:"Channel"})]})}),(0,g.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[0===n.length&&(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:7,className:"px-4 py-4 text-center text-sm text-gray-500",children:"Keine Einträge gefunden."})}),n.map(a=>(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{className:"px-4 py-3 text-gray-600",children:new Date(a.createdAt).toLocaleString()}),(0,g.jsxs)("td",{className:"px-3 py-2 text-gray-900 whitespace-nowrap",children:[a.firstName," ",a.lastName]}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-600 whitespace-nowrap",children:a.email}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-900 whitespace-nowrap",children:a.trackName}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-600 whitespace-nowrap",children:a.trackArtists}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-500 whitespace-nowrap",children:a.slotIndex+1}),(0,g.jsx)("td",{className:"px-3 py-2 text-gray-500 whitespace-nowrap",children:a.channel??"—"})]},a.id))]})]})})]})]})})]})}],7238);var j=a.i(7238),k=a.i(9193);let l=(0,d.hoist)(j,"default"),m=(0,d.hoist)(j,"getStaticProps"),n=(0,d.hoist)(j,"getStaticPaths"),o=(0,d.hoist)(j,"getServerSideProps"),p=(0,d.hoist)(j,"config"),q=(0,d.hoist)(j,"reportWebVitals"),r=(0,d.hoist)(j,"unstable_getStaticProps"),s=(0,d.hoist)(j,"unstable_getStaticPaths"),t=(0,d.hoist)(j,"unstable_getStaticParams"),u=(0,d.hoist)(j,"unstable_getServerProps"),v=(0,d.hoist)(j,"unstable_getServerSideProps"),w=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/admin/index",pathname:"/admin",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:j}),x=(0,k.getHandler)({srcPage:"/admin/index",config:p,userland:j,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r],6663)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_pages_e6b57c7f.js.map