module.exports=[406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},9173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},2911,e=>{"use strict";var t=e.i(9173);let r=global.__prisma??new t.PrismaClient;e.s(["default",0,r])},9860,e=>{"use strict";var t=e.i(6747),r=e.i(9245),i=e.i(4898),a=e.i(2950),n=e.i(2911);function s(e){return"string"==typeof e&&e.trim().length>0}function l(e){return e.trim()}async function o(e,t){if("POST"!==e.method){t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});return}try{let r="string"==typeof e.body?JSON.parse(e.body):e.body,i=function(e){if(!e||"object"!=typeof e)return{error:"Invalid input: body must be an object."};if(!s(e.firstName))return{error:"Invalid input: firstName is required."};if(!s(e.lastName))return{error:"Invalid input: lastName is required."};if(!s(e.email)||!e.email.includes("@"))return{error:"Invalid input: email must be a valid address."};if(!Array.isArray(e.tracks)||e.tracks.length<1||e.tracks.length>3)return{error:"Invalid input: tracks must contain between 1 and 3 items."};let t=[],r=new Set;for(let i=0;i<e.tracks.length;i+=1){let a=e.tracks[i];if(!a||"object"!=typeof a)return{error:`Invalid input: track at position ${i+1} is malformed.`};if(!s(a.id))return{error:`Invalid input: track id missing at position ${i+1}.`};if(!s(a.name))return{error:`Invalid input: track name missing at position ${i+1}.`};if(!s(a.artists))return{error:`Invalid input: track artists missing at position ${i+1}.`};let n={id:l(a.id),name:l(a.name),artists:l(a.artists),album:a.album?a.album.trim():void 0,spotify_url:a.spotify_url?a.spotify_url.trim():void 0,image_url:a.image_url?a.image_url.trim():void 0,duration_ms:"number"==typeof a.duration_ms?a.duration_ms:void 0};if(r.has(n.id))return{error:"Invalid input: duplicate track ids are not allowed."};r.add(n.id),t.push(n)}return{body:{firstName:l(e.firstName),lastName:l(e.lastName),email:l(e.email),tracks:t,channel:function(e){if(s(e))return e.trim()}(e.channel)}}}(r);if("error"in i)return void t.status(400).json({error:i.error});let{body:a}=i;if(await n.default.songWish.findFirst({where:{email:a.email}}))return void t.status(409).json({error:"Es ist nur eine Wunschabgabe pro Person erlaubt."});let o=a.tracks.map((e,t)=>({firstName:a.firstName,lastName:a.lastName,email:a.email,trackId:e.id,trackName:e.name,trackArtists:e.artists,album:e.album??null,imageUrl:e.image_url??null,spotifyUrl:e.spotify_url??null,durationMs:e.duration_ms??null,slotIndex:t,channel:a.channel??null}));await n.default.songWish.createMany({data:o}),t.status(200).json({success:!0})}catch(e){console.error("Error in /api/wish:",e),t.status(500).json({error:"Internal server error"})}}e.s(["default",()=>o],8732);var u=e.i(8732),d=e.i(7031),m=e.i(1927),p=e.i(6432);let c=(0,a.hoist)(u,"default"),f=(0,a.hoist)(u,"config"),h=new i.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/wish",pathname:"/api/wish",bundlePath:"",filename:""},userland:u,distDir:".next",relativeProjectDir:""});async function v(e,r,i){h.isDev&&(0,p.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/wish";a=a.replace(/\/index$/,"")||"/";let n=await h.prepare(e,r,{srcPage:a});if(!n){r.statusCode=400,r.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve());return}let{query:s,params:l,prerenderManifest:o,routerServerContext:u}=n;try{let t=e.method||"GET",i=(0,d.getTracer)(),n=i.getActiveScopeSpan(),p=h.instrumentationOnRequestError.bind(h),c=async n=>h.render(e,r,{query:{...s,...l},params:l,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:o.preview,propagateError:!1,dev:h.isDev,page:"/api/wish",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>p(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=i.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=e.get("next.route");if(s){let e=`${t} ${s}`;n.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),n.updateName(e)}else n.updateName(`${t} ${a}`)});n?await c(n):await i.withPropagatedContext(e.headers,()=>i.trace(m.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:d.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},c))}catch(e){if(h.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==i.waitUntil||i.waitUntil.call(i,Promise.resolve())}}e.s(["config",0,f,"default",0,c,"handler",()=>v],9860)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__34b0639f._.js.map